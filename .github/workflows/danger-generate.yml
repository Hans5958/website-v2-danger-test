on: 
  pull_request:
    branches:
      - master

name: Danger JS Check (Generate)

jobs:
  generate:
    name: Generate
    runs-on: ubuntu-latest
    steps:
      - name: Checkout ScratchAddons/website-v2
        uses: actions/checkout@v3
        with:
          path: repo
      - name: Checkout ScratchAddons/website-v2-script
        uses: actions/checkout@v3
        with:
          repository: ScratchAddons/website-v2-script
          ref: danger
          path: script

      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: 16.x 
      - name: Cache dependencies
        uses: actions/cache@v3
        with:
          path: ~/.npm
          key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}
          restore-keys: ${{ runner.os }}-node-

      - name: Execute script
        run: | 
          echo Running...
          cd repo
          bash ../script/sh/danger-generate.sh
